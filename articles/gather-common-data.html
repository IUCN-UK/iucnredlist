<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Gather Common Data • iucnredlist</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Gather Common Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">iucnredlist</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/assessment-data-responses.html">Assessment Data Responses</a></li>
    <li><a class="dropdown-item" href="../articles/gather-common-data.html">Gather Common Data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/IUCN-UK/iucnredlist/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Gather Common Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/IUCN-UK/iucnredlist/blob/main/vignettes/gather-common-data.Rmd" class="external-link"><code>vignettes/gather-common-data.Rmd</code></a></small>
      <div class="d-none name"><code>gather-common-data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This tutorial has been created to walk you through gathering common
data from the IUCN Red List API. In Part 1, we will stay completely
within the API by getting a list of species’ assessments directly from
the taxon endpoint. In Part 2, we will show you how to import your own
list of species’ names and perform the same data gathering steps.</p>
<div class="section level3">
<h3 id="part-1---gather-habitats-threats-for-the-felidae">Part 1 - Gather habitats &amp; threats for the <em>felidae</em><a class="anchor" aria-label="anchor" href="#part-1---gather-habitats-threats-for-the-felidae"></a>
</h3>
<p>First, you’ll want to load the package into your R session and then
initialise a connection to the Red List API. Initialising a connection
will require you to have a valid API token. If you don’t already have
one, you can sign up for one <a href="https://api.iucnredlist.org" class="external-link">here</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/IUCN-UK/iucnredlist" class="external-link">iucnredlist</a></span><span class="op">)</span></span>
<span><span class="va">api</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/init_api.html">init_api</a></span><span class="op">(</span><span class="st">"your_api_token"</span><span class="op">)</span></span></code></pre></div>
<p>We now need to gather a list of all (latest) assessments whose
species belong to the family <em>felidae</em>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>felidae <span class="ot">&lt;-</span> <span class="fu">assessments_by_taxonomy</span>(api, <span class="at">level =</span> <span class="st">"family"</span>, <span class="at">name =</span> <span class="st">"felidae"</span>, <span class="at">latest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># A tibble: 52 × 7</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>   sis_taxon_id assessment_id latest year_published scopes_description_en scopes_code url                                              </span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>          <span class="sc">&lt;</span>int<span class="sc">&gt;</span>         <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>lgl<span class="sc">&gt;</span>  <span class="er">&lt;</span>chr<span class="sc">&gt;</span>          <span class="er">&lt;</span>chr<span class="sc">&gt;</span>                 <span class="er">&lt;</span>chr<span class="sc">&gt;</span>       <span class="er">&lt;</span>chr<span class="sc">&gt;</span>                                            </span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a> <span class="dv">1</span>        <span class="dv">11638</span>       <span class="dv">3299247</span> <span class="cn">TRUE</span>   <span class="dv">2010</span>           Mediterranean         <span class="dv">4</span>           https<span class="sc">:</span><span class="er">//</span>www.iucnredlist.org<span class="sc">/</span>species<span class="sc">/</span><span class="dv">11638</span><span class="sc">/</span><span class="dv">3299247</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a> <span class="dv">2</span>        <span class="dv">12519</span>       <span class="dv">3350985</span> <span class="cn">TRUE</span>   <span class="dv">2010</span>           Mediterranean         <span class="dv">4</span>           https<span class="sc">:</span><span class="er">//</span>www.iucnredlist.org<span class="sc">/</span>species<span class="sc">/</span><span class="dv">12519</span><span class="sc">/</span><span class="dv">3350985</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a> <span class="dv">3</span>        <span class="dv">15951</span>       <span class="dv">5325996</span> <span class="cn">TRUE</span>   <span class="dv">2010</span>           Mediterranean         <span class="dv">4</span>           https<span class="sc">:</span><span class="er">//</span>www.iucnredlist.org<span class="sc">/</span>species<span class="sc">/</span><span class="dv">15951</span><span class="sc">/</span><span class="dv">5325996</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a> <span class="dv">4</span>        <span class="dv">15954</span>       <span class="dv">5328595</span> <span class="cn">TRUE</span>   <span class="dv">2010</span>           Mediterranean         <span class="dv">4</span>           https<span class="sc">:</span><span class="er">//</span>www.iucnredlist.org<span class="sc">/</span>species<span class="sc">/</span><span class="dv">15954</span><span class="sc">/</span><span class="dv">5328595</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a> <span class="dv">5</span>        <span class="dv">15955</span>       <span class="dv">5330476</span> <span class="cn">TRUE</span>   <span class="dv">2010</span>           Mediterranean         <span class="dv">4</span>           https<span class="sc">:</span><span class="er">//</span>www.iucnredlist.org<span class="sc">/</span>species<span class="sc">/</span><span class="dv">15955</span><span class="sc">/</span><span class="dv">5330476</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a> <span class="dv">6</span>         <span class="dv">3847</span>      <span class="dv">10121483</span> <span class="cn">TRUE</span>   <span class="dv">2010</span>           Mediterranean         <span class="dv">4</span>           https<span class="sc">:</span><span class="er">//</span>www.iucnredlist.org<span class="sc">/</span>species<span class="sc">/</span><span class="dv">3847</span><span class="sc">/</span><span class="dv">10121483</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a> <span class="dv">7</span>         <span class="dv">8540</span>      <span class="dv">12915840</span> <span class="cn">TRUE</span>   <span class="dv">2010</span>           Mediterranean         <span class="dv">4</span>           https<span class="sc">:</span><span class="er">//</span>www.iucnredlist.org<span class="sc">/</span>species<span class="sc">/</span><span class="dv">8540</span><span class="sc">/</span><span class="dv">12915840</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a> <span class="dv">8</span>         <span class="dv">8540</span>      <span class="dv">12916263</span> <span class="cn">TRUE</span>   <span class="dv">2007</span>           Europe                <span class="dv">2</span>           https<span class="sc">:</span><span class="er">//</span>www.iucnredlist.org<span class="sc">/</span>species<span class="sc">/</span><span class="dv">8540</span><span class="sc">/</span><span class="dv">12916263</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a> <span class="dv">9</span>         <span class="dv">8541</span>      <span class="dv">12916598</span> <span class="cn">TRUE</span>   <span class="dv">2010</span>           Mediterranean         <span class="dv">4</span>           https<span class="sc">:</span><span class="er">//</span>www.iucnredlist.org<span class="sc">/</span>species<span class="sc">/</span><span class="dv">8541</span><span class="sc">/</span><span class="dv">12916598</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="dv">10</span>          <span class="dv">219</span>      <span class="dv">13034035</span> <span class="cn">TRUE</span>   <span class="dv">2010</span>           Mediterranean         <span class="dv">4</span>           https<span class="sc">:</span><span class="er">//</span>www.iucnredlist.org<span class="sc">/</span>species<span class="sc">/</span><span class="dv">219</span><span class="sc">/</span><span class="dv">13034035</span> </span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co"># ℹ 42 more rows</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co"># ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
<p>As our aim is to gather all habitats and threats coded against these
assessments, we must now iterate over each unique assessment ID in the
above tibble to get that data. Helpfully, there’s a function available
to do just that:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pass assessment IDs into the assessment_data_many() function</span></span>
<span><span class="va">felidae_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessment_data_many.html">assessment_data_many</a></span><span class="op">(</span><span class="va">api</span>, assessment_ids <span class="op">=</span> <span class="va">felidae</span><span class="op">$</span><span class="va">assessment_id</span><span class="op">)</span></span></code></pre></div>
<p>After this runs, we will how have full assessment data for all 50
unique assessment IDs (as of time of publication). From here, we can
extract the data we are interested in with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">habitats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_element.html">extract_element</a></span><span class="op">(</span><span class="va">felidae_full</span>, <span class="st">"habitats"</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/extract_element.html">extract_element()</a></code> function is super helpful. It
returns a tidy dataframe of the element you’re interested; a row for
each unique element and assessment ID for all of the assessments you
gathered full assessment data for:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>habitats</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># A tibble: 452 × 7</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>   index    assessment_id majorImportance season suitability description                                                               code </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>    <span class="er">&lt;</span>chr<span class="sc">&gt;</span>         <span class="er">&lt;</span>chr<span class="sc">&gt;</span>           <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>chr<span class="sc">&gt;</span>       <span class="er">&lt;</span>chr<span class="sc">&gt;</span>                                                                     <span class="er">&lt;</span>chr<span class="sc">&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a> <span class="dv">1</span> habitats <span class="dv">3299247</span>       <span class="cn">NA</span>              <span class="cn">NA</span>     Suitable    <span class="fu">Wetlands</span> (inland) <span class="sc">-</span> Shrub Dominated Wetlands                              <span class="dv">5</span>_3  </span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a> <span class="dv">2</span> habitats <span class="dv">3299247</span>       <span class="cn">NA</span>              <span class="cn">NA</span>     Suitable    Grassland <span class="sc">-</span> Subtropical<span class="sc">/</span>Tropical High Altitude                            <span class="dv">4</span>_7  </span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a> <span class="dv">3</span> habitats <span class="dv">3299247</span>       <span class="cn">NA</span>              <span class="cn">NA</span>     Suitable    <span class="fu">Wetlands</span> (inland) <span class="sc">-</span> Permanent Rivers<span class="sc">/</span>Streams<span class="sc">/</span><span class="fu">Creeks</span> (includes waterfalls) <span class="dv">5</span>_1  </span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a> <span class="dv">4</span> habitats <span class="dv">3299247</span>       <span class="cn">NA</span>              <span class="cn">NA</span>     Suitable    Forest <span class="sc">-</span> Subtropical<span class="sc">/</span>Tropical Dry                                         <span class="dv">1</span>_5  </span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a> <span class="dv">5</span> habitats <span class="dv">3299247</span>       <span class="cn">NA</span>              <span class="cn">NA</span>     Suitable    Savanna <span class="sc">-</span> Dry                                                             <span class="dv">2</span>_1  </span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a> <span class="dv">6</span> habitats <span class="dv">3299247</span>       <span class="cn">NA</span>              <span class="cn">NA</span>     Suitable    Grassland <span class="sc">-</span> Subtropical<span class="sc">/</span>Tropical Dry                                      <span class="dv">4</span>_5  </span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a> <span class="dv">7</span> habitats <span class="dv">3299247</span>       <span class="cn">NA</span>              <span class="cn">NA</span>     Suitable    Grassland <span class="sc">-</span> Subtropical<span class="sc">/</span>Tropical Seasonally Wet<span class="sc">/</span>Flooded                   <span class="dv">4</span>_6  </span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a> <span class="dv">8</span> habitats <span class="dv">3350985</span>       <span class="cn">NA</span>              <span class="cn">NA</span>     Suitable    Shrubland <span class="sc">-</span> Boreal                                                        <span class="dv">3</span>_3  </span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a> <span class="dv">9</span> habitats <span class="dv">3350985</span>       <span class="cn">NA</span>              <span class="cn">NA</span>     Suitable    Shrubland <span class="sc">-</span> Subtropical<span class="sc">/</span>Tropical Dry                                      <span class="dv">3</span>_5  </span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="dv">10</span> habitats <span class="dv">3350985</span>       <span class="cn">NA</span>              <span class="cn">NA</span>     Suitable    Shrubland <span class="sc">-</span> Temperate                                                     <span class="dv">3</span>_4  </span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co"># ℹ 442 more rows</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co"># ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
<p>You can now do the same for threats:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>threats <span class="ot">&lt;-</span> <span class="fu">extract_element</span>(felidae_full, <span class="st">"threats"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>threats</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co"># A tibble: 653 × 13</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>   index   assessment_id scope timing                   internationalTrade score         severity ancestry virus ias   text  description                                       code </span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>   <span class="er">&lt;</span>chr<span class="sc">&gt;</span>         <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>                    <span class="er">&lt;</span>chr<span class="sc">&gt;</span>              <span class="er">&lt;</span>chr<span class="sc">&gt;</span>         <span class="er">&lt;</span>chr<span class="sc">&gt;</span>    <span class="er">&lt;</span>chr<span class="sc">&gt;</span>    <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>                                             <span class="er">&lt;</span>chr<span class="sc">&gt;</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a> <span class="dv">1</span> threats <span class="dv">3299247</span>       <span class="cn">NA</span>    Ongoing                  <span class="cn">NA</span>                 Low Impact<span class="sc">:</span> <span class="dv">3</span> <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    Agro<span class="sc">-</span>industry farming                             <span class="dv">2</span>_1_3</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a> <span class="dv">2</span> threats <span class="dv">3299247</span>       <span class="cn">NA</span>    Past, Unlikely to Return <span class="cn">NA</span>                 Past Impact   <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    Scale Unknown<span class="sc">/</span>Unrecorded                          <span class="dv">2</span>_3_4</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a> <span class="dv">3</span> threats <span class="dv">3299247</span>       <span class="cn">NA</span>    Ongoing                  <span class="cn">NA</span>                 Low Impact<span class="sc">:</span> <span class="dv">3</span> <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    Nomadic grazing                                   <span class="dv">2</span>_3_1</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a> <span class="dv">4</span> threats <span class="dv">3299247</span>       <span class="cn">NA</span>    Ongoing                  <span class="cn">NA</span>                 Low Impact<span class="sc">:</span> <span class="dv">3</span> <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    Intentional <span class="fu">use</span> (species is the target)           <span class="dv">5</span>_1_1</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a> <span class="dv">5</span> threats <span class="dv">3299247</span>       <span class="cn">NA</span>    Ongoing                  <span class="cn">NA</span>                 Low Impact<span class="sc">:</span> <span class="dv">3</span> <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    Agro<span class="sc">-</span>industry grazing, ranching or farming        <span class="dv">2</span>_3_3</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a> <span class="dv">6</span> threats <span class="dv">3299247</span>       <span class="cn">NA</span>    Ongoing                  <span class="cn">NA</span>                 Low Impact<span class="sc">:</span> <span class="dv">3</span> <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    Problematic native species<span class="sc">/</span>diseases               <span class="dv">8</span>_2  </span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a> <span class="dv">7</span> threats <span class="dv">3299247</span>       <span class="cn">NA</span>    Ongoing                  <span class="cn">NA</span>                 Low Impact<span class="sc">:</span> <span class="dv">3</span> <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    Persecution<span class="sc">/</span>control                               <span class="dv">5</span>_1_3</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a> <span class="dv">8</span> threats <span class="dv">3299247</span>       <span class="cn">NA</span>    Ongoing                  <span class="cn">NA</span>                 Low Impact<span class="sc">:</span> <span class="dv">3</span> <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    Unintentional <span class="fu">effects</span> (species is not the target) <span class="dv">5</span>_1_2</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a> <span class="dv">9</span> threats <span class="dv">3299247</span>       <span class="cn">NA</span>    Ongoing                  <span class="cn">NA</span>                 Low Impact<span class="sc">:</span> <span class="dv">3</span> <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    Small<span class="sc">-</span>holder grazing, ranching or farming         <span class="dv">2</span>_3_2</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="dv">10</span> threats <span class="dv">3299247</span>       <span class="cn">NA</span>    Ongoing                  <span class="cn">NA</span>                 Low Impact<span class="sc">:</span> <span class="dv">3</span> <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    Trend Unknown<span class="sc">/</span>Unrecorded                          <span class="dv">7</span>_1_3</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co"># ℹ 643 more rows</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co"># ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
<p>So, how do you know what elements are available for you to extract
data from? The short answer is you can call <code><a href="../reference/element_names.html">element_names()</a></code>
to get them:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">element_names</span>()</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">"assessment_date"</span>               <span class="st">"assessment_id"</span>                 <span class="st">"assessment_points"</span>             <span class="st">"assessment_ranges"</span>             <span class="st">"biogeographical_realms"</span>        <span class="st">"citation"</span>                     </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a> [<span class="dv">7</span>] <span class="st">"conservation_actions"</span>          <span class="st">"conservation_actions_in_place"</span> <span class="st">"credits"</span>                       <span class="st">"criteria"</span>                      <span class="st">"errata"</span>                        <span class="st">"faos"</span>                         </span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>[<span class="dv">13</span>] <span class="st">"growth_forms"</span>                  <span class="st">"habitats"</span>                      <span class="st">"latest"</span>                        <span class="st">"lmes"</span>                          <span class="st">"locations"</span>                     <span class="st">"population_trend"</span>             </span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>[<span class="dv">19</span>] <span class="st">"possibly_extinct"</span>              <span class="st">"possibly_extinct_in_the_wild"</span>  <span class="st">"red_list_category"</span>             <span class="st">"references"</span>                    <span class="st">"researches"</span>                    <span class="st">"scopes"</span>                       </span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>[<span class="dv">25</span>] <span class="st">"sis_taxon_id"</span>                  <span class="st">"stresses"</span>                      <span class="st">"supplementary_info"</span>            <span class="st">"systems"</span>                       <span class="st">"taxon"</span>                         <span class="st">"taxon_common_names"</span>           </span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>[<span class="dv">31</span>] <span class="st">"taxon_ssc_groups"</span>              <span class="st">"taxon_synonyms"</span>                <span class="st">"threats"</span>                       <span class="st">"url"</span>                           <span class="st">"use_and_trade"</span>                 <span class="st">"year_published"</span>      </span></code></pre></div>
<p>The long answer is that the element names are simply the named
elements in a <em>parsed</em> assessment data object. So you could just
as well run <code>names(felidae_full[[1]])</code> to get the same list
of element names.</p>
<p>Pass any of the above element names into
<code><a href="../reference/extract_element.html">extract_element()</a></code> to get a tidy dataframe of those
elements.</p>
</div>
<div class="section level3">
<h3 id="part-2---gather-habitats-threats-for-a-custom-list-of-species">Part 2 - Gather habitats &amp; threats for a custom list of
species<a class="anchor" aria-label="anchor" href="#part-2---gather-habitats-threats-for-a-custom-list-of-species"></a>
</h3>
<p>In Part 1, we showed how to stay completely within the API to get
habitats and threats for the <em>felidae</em>. What if you have your own
list of binomial names?</p>
<p>For the sake of this tutorial, let’s build a quick
<code>tibble()</code> with some species in it:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">my_species</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>genus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Panthera"</span>, <span class="st">"Diceros"</span>, <span class="st">"Cyclura"</span><span class="op">)</span>, </span>
<span>                            species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"leo"</span>, <span class="st">"bicornis"</span>, <span class="st">"pinguis"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We could get ‘minimal’ assessment data for the first species in our
list, just to see what it looks like:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/assessments_by_name.html">assessments_by_name</a></span><span class="op">(</span><span class="va">api</span>, </span>
<span>                    genus <span class="op">=</span> <span class="va">my_species</span><span class="op">$</span><span class="va">genus</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                    species <span class="op">=</span> <span class="va">my_species</span><span class="op">$</span><span class="va">species</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>A single species on its own probably isn’t that useful, so let’s
write a quick loop to iterate over each Latin binomial and get all the
latest global assessments:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">assessments</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">my_species</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">assessments</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessments_by_name.html">assessments_by_name</a></span><span class="op">(</span><span class="va">api</span>, </span>
<span>                                          genus <span class="op">=</span> <span class="va">my_species</span><span class="op">$</span><span class="va">genus</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>                                          species <span class="op">=</span> <span class="va">my_species</span><span class="op">$</span><span class="va">species</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Unlist into a tibble</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">assessments</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter on latest global assessments</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">latest</span> <span class="op">==</span> <span class="cn">TRUE</span> <span class="op">&amp;</span> <span class="va">scopes_code</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>As before, we can now pass our list of assessment IDs like so:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">full_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessment_data_many.html">assessment_data_many</a></span><span class="op">(</span><span class="va">api</span>, </span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">assessment_id</span><span class="op">)</span>,</span>
<span>                                  wait_time<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>We can now extract habitats and threats with:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">habitats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_element.html">extract_element</a></span><span class="op">(</span><span class="va">full_data</span>, <span class="st">"habitats"</span><span class="op">)</span></span>
<span><span class="va">threats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_element.html">extract_element</a></span><span class="op">(</span><span class="va">full_data</span>, <span class="st">"habitats"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Simon Tarr, Ian Townsend, International Union for Conservation of Nature.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
